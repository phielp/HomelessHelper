<html>
<head>
	<script>
		function login() {
			var userName = document.getElementById("userName").value;
			var password = document.getElementById("password").value;
			
			var user = '{"userName":"'+userName+'", "password":"'+password+'"}';
			
			var xhttp = new XMLHttpRequest();
			
			xhttp.onreadystatechange = function() {
				if (this.readyState == 4 && this.status == 200) {
					var check = this.responseText;
					var data = JSON.parse(check);
					loginProceed(data);
				}
			};
      		xhttp.open("POST", "http://localhost:8080/login");
			xhttp.setRequestHeader("Content-type", "application/json");
			xhttp.send(user);
		}
		
		function loginProceed(data) {
			if (data[0] == true){
				if (data[1] == true) {
					location.href="Supplier.html";
				}
				else {
// 					var id = data[2];
// 					write.document(id);
					location.href="Demander.html";
					
				}
			}
			else {
				document.getElementById("inlogfout").innerHTML = "Combination of username and password unknown"}
			}
		
			function setCookie(cname,cvalue,exdays) {
			    var d = new Date();
			    d.setTime(d.getTime() + (exdays*24*60*60*1000));
			    var expires = "expires=" + d.toGMTString();
			    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
			}
	
			function getCookie(cname) {
			    var name = cname + "=";
			    var decodedCookie = decodeURIComponent(document.cookie);
			    var ca = decodedCookie.split(';');
			    for(var i = 0; i < ca.length; i++) {
			        var c = ca[i];
			        while (c.charAt(0) == ' ') {
			            c = c.substring(1);
			        }
			        if (c.indexOf(name) == 0) {
			            return c.substring(name.length, c.length);
			        }
			    }
			    return "";
			}
	
			function checkCookie() {
			    var user=getCookie("username");
			    if (user != "") {
			        alert("Welcome again " + user);
			    } else {
			       user = prompt("Please enter your name:","");
			       if (user != "" && user != null) {
			           setCookie("username", user, 30);
			       }
			    }
			}	
	</script>

<body onload="checkCookie()">
	LOGIN:
	<br>
	<input type="text" id="userName" placeholder="Username">
	<br>
	<input type="password" id="password" placeholder="Password">
	<br>
	<button type="button" id="loginButton" onclick="login()">Login</button>
	<button type="button" id="registerButton" onclick=location.href="Register.html" >Register</button>
	<p id="inlogfout"></p>
	<br>
	<button type="button" id="buttoninput" onclick="test()">creeer een cookie</button>
</body>
</head>
</html>